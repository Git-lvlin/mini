var IMG_CDN = "http://dev-yeahgo-oss.waiad.icu/"

// 格式化图片路径
var getImgUrl = function (url) {
  return IMG_CDN + url;
}

// 拆解价格
var getPriceSplit = function (price, type) {
  var str = price !== undefined ? price.toString() : "0";
  var strArr = str.split(".");
  if(!type) {
    return strArr[0];
  } else {
    return !!strArr[1] ? "." + strArr[1] : "";
  }
}

// 浮点数相加
var floatAdd = function(arg1, arg2) {
  arg1 = !arg1 ? 0 : arg1
  arg2 = !arg2 ? 0 : arg2
  var r1, r2, m, c;
  r1 = !!arg1.toString().split(".")[1] ? arg1.toString().split(".")[1].length : 0;
  r2 = !!arg2.toString().split(".")[1] ? arg2.toString().split(".")[1].length : 0;
  c = Math.abs(r1 - r2);
  m = Math.pow(10, Math.max(r1, r2));
  if (c > 0) {
    var cm = Math.pow(10, c);
    if (r1 > r2) {
      arg1 = Number(arg1.toString().replace(".", ""));
      arg2 = Number(arg2.toString().replace(".", ""));
      arg2 = arg2 * cm;
    } else {
      arg1 = Number(arg1.toString().replace(".", ""));
      arg1 = arg1  * cm;
      arg2 = Number(arg2.toString().replace(".", ""));
    }
  } else {
    arg1 = Number(arg1.toString().replace(".", ""));
    arg2 = Number(arg2.toString().replace(".", ""));
  }
  return (arg1 + arg2) / m;
}

// 浮点数相减
var floatReduce = function(arg1, arg2) {
  arg1 = !arg1 ? 0 : arg1
  arg2 = !arg2 ? 0 : arg2
  var r1, r2, m, n;
  r1 = !!arg1.toString().split(".")[1] ? arg1.toString().split(".")[1].length : 0;
  r2 = !!arg2.toString().split(".")[1] ? arg2.toString().split(".")[1].length : 0;
  //动态控制精度长度
  m = Math.pow(10, Math.max(r1, r2));
  n = (r1 >= r2) ? r1 : r2;
  return ((arg1 * m - arg2 * m) / m).toFixed(n);
}


module.exports = {
  floatAdd: floatAdd,
  floatReduce: floatReduce,
  getImgUrl: getImgUrl,
  getPriceSplit: getPriceSplit,
}