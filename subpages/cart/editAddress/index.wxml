<wxs module="tools" src="../../../wxs/common.wxs" />

<view class="container">
  <view class="content_view">
    <view class="form_item" >
      <view class="form_name">收货人</view>
      <input
        class="form_input"
        maxlength="10"
        placeholder="请输入姓名"
        placeholder-class="form_placeholder"
        data-field="consignee"
        bindinput="handleInput"
      />
    </view>
    <view class="form_item" >
      <view class="form_name">手机号码</view>
      <input
        type="number"
        class="form_input"
        maxlength="11"
        placeholder="请输入手机号码"
        placeholder-class="form_placeholder"
        data-field="phone"
        bindinput="handleInput"
      />
    </view>
    <view class="form_item" >
      <view class="form_name">所在地区</view>
      <input
        class="form_input"
        value="{{selectAddress.areaStr}}"
        disabled="{{true}}"
        placeholder="省市区县、乡镇等"
        placeholder-class="form_placeholder"
        bindtap="onOpenAddress"
      />
      <view class="location" wx:if="{{false}}">
        <image class="location_icon" src="{{tools.getImgUrl('miniprogram/common/location.png')}}" />定位
      </view>
    </view>
    <view class="form_item" >
      <view class="form_name">详细地址</view>
      <textarea
        class="form_input form_textarea"
        placeholder="请输入街道地址，例如：西街108号101"
        placeholder-class="form_placeholder"
        data-field="address"
        bindinput="handleInput"
      />
    </view>
  </view>

  <view class="set_default content_view">
    <view class="set_info">
      <view class="default_title">设为默认地址</view>
      <view class="explain">提醒：每次下单会自动默认推荐使用该地址</view>
    </view>
    <van-switch
      size="36rpx"
      checked="{{ isDefault }}"
      active-color="#e5352f"
      inactive-color="#eeeeee"
      bind:change="handleSwitch"
    />
  </view>

  <view class="save_btn" bindtap="onSave">保存</view>

  <van-popup
    round
    show="{{ showPopup }}"
    position="bottom"
    closeable
    custom-style="height: 1100rpx;"
    bind:close="onCloseAddress"
  >
    <view class="address_content">
      <view class="address_head">
        <view class="head_content">
          <view class="head_title">请选择所在地区</view>
          <view class="country_list">
            <view class="country_child">中国大陆</view>
          </view>
          <view class="area_detail">
            <view
              class="area_text {{selectAddress.isAct === 'province' ? 'area_text_act' : ''}}"
              data-type="province"
              bindtap="onSelectAddressType"
            >{{!!selectAddress.province.name ? selectAddress.province.name : "请选择" }}</view>
            <view
              class="area_text {{selectAddress.isAct === 'city' ? 'area_text_act' : ''}}"
              data-type="city"
              bindtap="onSelectAddressType"
            >{{!!selectAddress.city.name ? selectAddress.city.name : "请选择" }}</view>
            <view
              class="area_text {{selectAddress.isAct === 'area' ? 'area_text_act' : ''}}"
              data-type="area"
              bindtap="onSelectAddressType"
            >{{!!selectAddress.area.name ? selectAddress.area.name : "请选择" }}</view>
          </view>
        </view>
      </view>
      <view class="address_list">
        <scroll-view scroll-y class="address_scroll" bindscroll="onAreaScroll">
          <view
            wx:for="{{areaList}}"
            wx:key="letter"
            wx:if="{{!!item.children.length}}"
            class="add_list"
          >
            <view class="area_list_text area_list_title" >{{item.letter}}</view>
            <view
              wx:for="{{item.children}}"
              wx:for-index="idx"
              wx:key="idx"
              wx:for-item="child"
              class="area_list_text"
              data-data="{{child.data}}"
              data-idx="{{idx}}"
              data-pidx="{{index}}"
              bindtap="onSelectArea"
            >
              <image
                class="select_icon"
                wx:if="{{selectAddress[selectAddress.isAct].pidx === index && selectAddress[selectAddress.isAct].idx === idx}}"
                src="{{tools.getImgUrl('miniprogram/cart/order/addres_select.png')}}"
              />
              {{child.name}}
            </view>
          </view>
        </scroll-view>

        <view class="letter_list">
          <view
            wx:for="{{letterList}}"
            wx:key="index"
            class="letter_item"
          >{{item}}</view>
        </view>
      </view>

    </view>
  </van-popup>
</view>